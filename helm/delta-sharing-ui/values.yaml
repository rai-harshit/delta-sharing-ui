# Default values for delta-sharing-ui

# -- Global settings
global:
  # -- Image pull secrets
  imagePullSecrets: []

# -- Backend configuration
backend:
  # -- Number of backend replicas
  replicaCount: 2
  
  image:
    repository: ghcr.io/your-org/delta-sharing-ui-backend
    tag: "latest"
    pullPolicy: IfNotPresent
  
  # -- Service configuration
  service:
    type: ClusterIP
    port: 5000
  
  # -- Resource limits
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  
  # -- Pod security context
  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
  
  # -- Node selector
  nodeSelector: {}
  
  # -- Tolerations
  tolerations: []
  
  # -- Affinity rules
  affinity: {}
  
  # -- Extra environment variables
  extraEnv: []

# -- Frontend configuration
frontend:
  # -- Number of frontend replicas
  replicaCount: 2
  
  image:
    repository: ghcr.io/your-org/delta-sharing-ui-frontend
    tag: "latest"
    pullPolicy: IfNotPresent
  
  # -- Build mode: full, provider, recipient
  buildMode: full
  
  service:
    type: ClusterIP
    port: 80
  
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "128Mi"
      cpu: "200m"
  
  nodeSelector: {}
  tolerations: []
  affinity: {}

# -- Ingress configuration
ingress:
  enabled: true
  className: nginx
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-body-size: "50m"
  hosts:
    - host: delta-sharing.example.com
      paths:
        - path: /
          pathType: Prefix
          service: frontend
        - path: /api
          pathType: Prefix
          service: backend
  tls:
    - secretName: delta-sharing-tls
      hosts:
        - delta-sharing.example.com

# -- PostgreSQL configuration
postgresql:
  # -- Enable bundled PostgreSQL
  enabled: true
  
  auth:
    username: postgres
    password: ""  # Will be auto-generated if empty
    database: delta_sharing
  
  primary:
    persistence:
      enabled: true
      size: 10Gi

# -- External database configuration (when postgresql.enabled is false)
externalDatabase:
  host: ""
  port: 5432
  database: delta_sharing
  username: postgres
  password: ""
  existingSecret: ""
  existingSecretKey: ""

# -- Redis configuration
redis:
  # -- Enable bundled Redis
  enabled: true
  
  auth:
    enabled: false  # Set to true and configure password for production
    password: ""
  
  architecture: standalone  # or replication
  
  master:
    persistence:
      enabled: true
      size: 1Gi
    resources:
      requests:
        memory: "64Mi"
        cpu: "50m"
      limits:
        memory: "128Mi"
        cpu: "200m"

# -- External Redis configuration (when redis.enabled is false)
externalRedis:
  host: ""
  port: 6379
  password: ""
  existingSecret: ""
  existingSecretKey: ""

# -- Authentication configuration
# IMPORTANT: All secrets below are REQUIRED for production deployments.
# Generate with: openssl rand -base64 32
auth:
  # -- JWT secret for token signing (REQUIRED - must be overridden)
  # Generate with: openssl rand -base64 32
  jwtSecret: ""
  
  # -- Encryption key for storage credentials (REQUIRED - 64 hex chars)
  # Generate with: openssl rand -hex 32
  encryptionKey: ""
  
  # -- Admin user settings (REQUIRED - must be overridden)
  admin:
    # -- Default admin email (REQUIRED - must be overridden)
    email: ""
    # -- Default admin password (REQUIRED - must be overridden, will be forced to change on first login)
    password: ""

# -- Hybrid mode configuration
hybridMode:
  # -- Enable hybrid mode (use OSS Delta Sharing server)
  enabled: false
  
  # -- Delta Sharing server endpoint
  endpoint: ""
  
  # -- Config directory for OSS server
  configDir: "/config"

# -- Cloud storage credentials (optional)
storage:
  aws:
    accessKeyId: ""
    secretAccessKey: ""
    region: ""
  
  azure:
    accountName: ""
    accountKey: ""
  
  gcs:
    projectId: ""
    keyFile: ""  # Base64 encoded JSON key

# -- Pod disruption budget
podDisruptionBudget:
  enabled: true
  minAvailable: 1

# -- Service monitor for Prometheus
serviceMonitor:
  enabled: false
  interval: 30s
  scrapeTimeout: 10s

# -- Horizontal Pod Autoscaler
autoscaling:
  backend:
    enabled: false
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 80
  
  frontend:
    enabled: false
    minReplicas: 2
    maxReplicas: 5
    targetCPUUtilizationPercentage: 80

# -- Network Policy
networkPolicy:
  enabled: false
  
  # -- Allow ingress from these namespaces
  allowedNamespaces: []
  
  # -- Custom ingress rules
  customRules: []

# -- SSO Configuration (OIDC)
sso:
  # -- Enable SSO authentication
  enabled: false
  
  # -- SSO provider: oidc, azure, okta
  provider: oidc
  
  # -- Generic OIDC settings
  oidc:
    issuerUrl: ""
    clientId: ""
    clientSecret: ""
    scopes: "openid,profile,email"
  
  # -- Azure AD settings
  azure:
    tenantId: ""
    clientId: ""
    clientSecret: ""
    adminGroupId: ""  # Azure AD group for admin access
  
  # -- Okta settings
  okta:
    domain: ""  # e.g., your-org.okta.com
    clientId: ""
    clientSecret: ""
    adminGroup: ""  # Okta group for admin access

# -- Webhooks configuration
webhooks:
  enabled: false
  # -- Webhook endpoints
  endpoints: []
  # Example:
  # - name: slack
  #   url: https://hooks.slack.com/services/xxx
  #   events: [share.created, recipient.created]
  # - name: teams
  #   url: https://outlook.office.com/webhook/xxx
  #   events: [access.granted, access.revoked]








